---
globs: *.test.ts,*.test.tsx,*.spec.ts,*.spec.tsx
description: "Testing strategy and quality assurance for academic integrity"
---

# Testing & Quality Assurance Standards

## Testing Strategy Overview
Academic writing tools require exceptional accuracy and reliability. All AI components must be thoroughly validated to prevent hallucinations and citation errors.

## Test Coverage Requirements
1. **Unit Tests:** Prompt builders, citation resolver, data validation schemas
2. **Integration Tests:** Upload → summary flow using fixture PDFs, end-to-end drafting pipeline  
3. **Snapshot Tests:** `.docx` output formatting, bibliography generation
4. **Load Tests:** Section Writer performance under concurrency, LLM rate limiting

## AI-Specific Validation
- **Hallucination Checks:** Automated verification that citations map to source chunks
- **Citation Accuracy:** Validate placeholder format and source ID mapping
- **Academic Tone:** Classifier tests for appropriate scholarly language
- **Source Attribution:** Ensure every claim traces back to uploaded material

## Critical Test Scenarios
- Large PDF extraction (>20MB documents)
- Scanned documents requiring OCR fallback
- Missing metadata causing citation template fallbacks
- Concurrent section generation with shared source pool
- Export formatting with various citation styles (APA/MLA/Chicago)

## Quality Metrics to Monitor
- Source extraction success rate ≥ 90%
- Citation placeholder conversion success rate ≥ 95%
- Export formatting validation pass rate ≥ 95%
- Zero hallucinated citations in automated checks

## Evaluation Framework
- Build dataset of anonymized sample theses for offline testing
- Define metrics: factual consistency, citation accuracy, readability, user edit distance
- Run nightly evaluation pipeline with regression thresholds
- Maintain human QA sample review (10% of outputs)

Critical: Any test failure related to citation accuracy or source attribution should block deployment.

Reference [tasks.md](mdc:tasks.md) sections 7-8 for detailed quality assurance requirements.